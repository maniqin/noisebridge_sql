<!doctype html>
<html>
  <head>
	<meta charset="utf-8" />
	<meta
	  name="viewport"
	  content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
	/>

	<title>SQL Class - Noisebridge</title>

	<link rel="stylesheet" href="../slide/reveal/css/reset.css">
	<link rel="stylesheet" href="../slide/reveal/css/reveal.css">
	<link rel="stylesheet" href="../slide/reveal/css/theme/black.css">
	<link rel="stylesheet" href="../slide/css/templates.css">

	<!-- Theme used for syntax highlighting of code -->
	<link rel="stylesheet" href="../slide/reveal/lib/css/monokai.css">
	
</head>

<body>
	<div class="reveal">
		<div class="slides">

			<!-- -------------------------------------------------------------------- -->
			<!-- Intro --> 
			<!-- id: 1 -->
			<!-- -------------------------------------------------------------------- -->
			<section id="intro">
				<h3>Noisebridge - SQL class</h3>
				<h3>Intro to SQL - Class #3 </h4>
					<br>
					<div class="side-bullet-point">
						<div>
							<h4>Useful links: </h4>
							<ul>
								<li><a href="https://www.meetup.com/TBD">Meetup</a></li>
								<li><a href="https://wiki.noisebridge.net/TBD">NB wiki</a></li>
								<li><a href="https://www.github.com/maniqin/noisebridge_sql">Github Repo</a></li>
							</ul>
						</div>
						<div>
							<img src="../slide/assets/nb_logo.svg" alt="Noisebridge Logo">
						</div>
					</div>
				</section>

				<!-- -------------------------------------------------------------------- -->
				<!-- Previous Class -->
				<!-- id: 2 -->
				<!-- -------------------------------------------------------------------- -->

				<section data-background="#002b36">Previous class review:
					<pre>
						<code class="hljs markdown" data-trim data-noescape>
						## Make sure to have a db installed (download a sqlite db file)

						- Previous class review
							- NULL values
							- Aliases (as)
							- Sorting Data (ORDER BY)
							- WHERE clause
						</code>
					</pre>
				</section>


		<!-- -------------------------------------------------------------------- 
		vertical stack template 
		id: 9
		-------------------------------------------------------------------- -->

		<section class="stack" data-background="#002b36">

				<!-- -------------------------------------------------------------------- -->
				<!-- Title bullet points and code template -->
				<!-- id: 8 -->
				<!-- Title: RANDOM() function -->
				<!-- -------------------------------------------------------------------- -->

				<section data-background="#002b36">
					<h5>Built-in RANDOM() function</h5>
					<ul>
						<li>other SQL dialects use RAND() sometimes</li>
						<li>if called by itself it outputs a number</li>
						<li>Example: </li>
						<pre>
							<code class="hljs" data-trim data-noescape>
						SELECT random();
			            -- no FROM because it doesnt really come from a table
							</code>
						</pre>
					</ul>
				</section>

				<!-- -------------------------------------------------------------------- -->
				<!-- Title bullet points and code template -->
				<!-- id: 8 -->
				<!-- Title:  -->
				<!-- -------------------------------------------------------------------- -->

				<section data-background="#002b36">
					<ul>
						<li>very useful to use in comination with ORDER BY</li>
						<li>Example:</li>

						<pre>
							<code class="hljs" data-trim data-noescape>
				            SELECT col_1,
				                    col_2
				                FROM table_name
				            ORDER BY RANDOM();
							</code>
						</pre>
						<li>Throw in a LIMIT too, great to get a random sample:</li>

						<pre>
							<code class="hljs" data-trim data-noescape>
					       SELECT col_1,
					                    col_2
					                FROM table_name
					            ORDER BY RANDOM()
					            LIMIT 10; 
							</code>
						</pre>
					</ul>
				</section>

		</section>

		<!-- -------------------------------------------------------------------- 
		vertical stack template 
		id: 9
		-------------------------------------------------------------------- -->
		<section class="stack" data-background="#002b36">

			<!-- -------------------------------------------------------------------- -->
			<!-- table template -->
			<!-- id: 14 -->
			<!-- COMPARISON OPERATORS:
				< > = >= <= != (same as <>)
				(in table) -->
			<!-- -------------------------------------------------------------------- -->
			<section class="table">
				<h2>COMPARISON OPERATORS</h2>
				<table>
					<thead>
						<tr>
							<th>Operator</th>
							<th>Meaning</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td><</td>
							<td>Less than</td>
						</tr>
						<tr>
							<td>></td>
							<td>More than</td>
						</tr>
						<tr>
							<td>=</td>
							<td>equals to</td>
						</tr>
						<tr>
							<td><=</td>
							<td>less than or equal to</td>
						</tr>
						<tr>
							<td>>=</td>
							<td>greater than or equal to</td>
						</tr>
						<tr>
							<td>!= (or <>)</td>
							<td>not equal to</td>
						</tr>
					</tbody>
				</table>
			</section>



				<!-- -------------------------------------------------------------------- -->
				<!-- double_bullet_list -->
				<!-- id: 7 -->
				<!-- Title:  -->
				<!-- -------------------------------------------------------------------- -->

				<section data-background="#002b36">
					<h5></h5>
					<div class="side-bullet-point">
						<p></p>
						<div>
							<ul>
								<li>Can use comparison operators in where clauses</li>
									<ul>
										<li>to filter for specific numbers</li>
										<li>to filter for strings (= or !=)</li>
										<li>to filter for dates</li>
										<li>more...</li>
									</ul>
								
								<li>Can use comparison operators in case when statements</li>
									<ul>
										<li>to compare numbers</li>
										<li>to compare strings</li>
										<li>to compare dates</li>
										<li>more...</li>
									</ul>
								
							</ul>
						</div>
						<div>
							<img src="#" alt="good image!">
						</div>

					</div>
				</section>

		</section>


		<!-- -------------------------------------------------------------------- 
		vertical stack template 
		id: 9
		-------------------------------------------------------------------- -->
		<section class="stack" data-background="#002b36">

				<!-- -------------------------------------------------------------------- -->
				<!-- double_bullet_list -->
				<!-- id: 7 -->
				<!-- Title:  -->
				<!-- -------------------------------------------------------------------- -->

				<section data-background="#002b36">
					<h5></h5>
					<div class="side-bullet-point">
						<p></p>
						<div>
							<ul>
								<li>SQL uses number operators that are very familiar</li>
									<ul>
										<li>Addition: +</li>
										<li>Subtraction: -</li>
										<li>Multiplication: *</li>
										<li>Division: /</li>
										<li>Modulo or Remainder: // (or MOD() in some SQL syntaxes)</li>
										<li>Exponentiation: 
											<ul>
												<li>POWER() in postgreSQL</li>
												<li>not possible in SQLite, or is it... ?</li>
											</ul> 
										<li>Square root https://www.sqlite.org/contrib -- unavailable functions</li>
									</ul>

								<li>Can use them on individual values</li>
									<ul>
										<li>- ie: column_1 - column_2</li>
									</ul>
								<li>Or on aggregates (we'll see these later)</li>
									<ul>
										<li>- ie: sum(column_1) - sum(column_2)</li>
									</ul>
							</ul>
						</div>
						<div>
							<img src="#" alt="good image!">
						</div>

					</div>
				</section>


		</section>





		<!-- -------------------------------------------------------------------- 
		vertical stack template 
		id: 9
		-------------------------------------------------------------------- -->
		<section class="stack" data-background="#002b36">

				<!-- -------------------------------------------------------------------- -->
				<!-- only_code -->
				<!-- id: 10 -->
				<!-- Title: Code for Nulls -->
				<!-- -------------------------------------------------------------------- -->

				<section data-background="#002b36">
					<h5>CASE (IF) statements</h5>
					<p>CASE is your classic IF statement</p>
					<pre>
						<code class="hljs markdown" data-trim data-noescape>
							Pseudo code:
								IF this condition is true
									THEN do this
								ELSE do that
						</code>

					</pre>
				</section>

				<!-- -------------------------------------------------------------------- -->
				<!-- double_bullet_list -->
				<!-- id: 7 -->
				<!-- Title:  -->
				<!-- -------------------------------------------------------------------- -->

				<section data-background="#002b36">
					<h5>How to build a CASE statement in SQL</h5>
					<div class="side-bullet-point">
						<div>
							<ul>
								<li>Condition to evaluate goes after CASE keyword</li>
									<ul>
										<li>Can check if value is above or below another value (using > or <)</li>
											<ul>
												<li>Or in between a range of values (recall BETWEEN AND)</li>
											</ul>
										<li>Can check if a varchar column matches a speciic string</li>
										<li>Can check for value in list of values (using IN keyword)</li>
									</ul>
								
								<li>Result action after condition check goes after the THEN keyword</li>
									<ul>
										<li>This may not make sense right now, let's look at some code...</li>
									</ul>
								
							</ul>
						</div>
					</div>
				</section>


				<!-- -------------------------------------------------------------------- -->
				<!-- only_code -->
				<!-- id: 10 -->
				<!-- Title: Code for Nulls -->
				<!-- -------------------------------------------------------------------- -->

				<section data-background="#002b36">
					<p>CASE WHEN code:</p>
					<pre>
						<code class="hljs" data-trim data-noescape>
						-- here CASE WHEN is used to create a column that will act as a 'flag'
						-- i.e. to specify if the value at that row is less or greater than 10
						SELECT
							id,
							num_col,
							CASE WHEN num_col > 10
								THEN 'value is greater than 10'
								ELSE 'value is less than 10'
								END AS ten_check,
							FROM table_name; 
						</code>

					</pre>
				</section>


				<!-- -------------------------------------------------------------------- -->
				<!-- Title bullet points and code template -->
				<!-- id: 8 -->
				<!-- Title: RANDOM() function -->
				<!-- -------------------------------------------------------------------- -->
				<section data-background="#002b36">
					<ul>
						<li>Case when with multiple conditions</li>

						<pre>
							<code class="hljs" data-trim data-noescape>
							CASE WHEN my_num_col > 2 AND my_varchar_col LIKE '%search%'
								THEN 'custom output'
								ELSE NULL END AS my_col_name
							</code>
						</pre>
					</ul>
				</section>


				<!-- -------------------------------------------------------------------- -->
				<!-- only_code -->
				<!-- id: 10 -->
				<!-- Title: Code for Nulls -->
				<!-- -------------------------------------------------------------------- -->

				<section data-background="#002b36">
					<p>case when with multiple WHENs</p>
					<pre>
						<code class="hljs" data-trim data-noescape>
							CASE 
								WHEN num_col > 2
									THEN 'output 1'
								WHEN other_num_col < 25 OR other_varchar_col = 'exact string'
									THEN 'output 2'
								WHEN num_col = 10
									THEN 'output 3'
								ELSE NULL END AS my_col_name
						</code>

					</pre>
				</section>

				<!-- -------------------------------------------------------------------- -->
				<!-- only_code -->
				<!-- id: 10 -->
				<!-- Title: Code for Nulls -->
				<!-- -------------------------------------------------------------------- -->

				<section data-background="#002b36">
					<p>CASE with the same field</p>
					<pre>
						<code class="hljs" data-trim data-noescape>
					--(looks like more of a switch case, for those of you who are familiar)
						CASE field
							WHEN condition
								THEN 'output_1'
							WHEN condition_2 -- on the same field 
								THEN 'output_2'
							ELSE NULL END AS my_col_name
						</code>

					</pre>
				</section>


				<!-- -------------------------------------------------------------------- -->
				<!-- only_code -->
				<!-- id: 10 -->
				<!-- Title: Code for Nulls -->
				<!-- -------------------------------------------------------------------- -->

				<section data-background="#002b36">
					<p>nested CASE WHEN</p>
					<pre>
						<code class="hljs" data-trim data-noescape>
						CASE WHEN field_1 = 'some string'
							THEN
								CASE WHEN field_2 > 20 
									THEN 'output_1'
								ELSE NULL END
							WHEN field_3 > 100
								THEN 'output_2'
							ELSE NULL END AS nested_check

						</code>

					</pre>
				</section>


				<!-- -------------------------------------------------------------------- -->
				<!-- only_code -->
				<!-- id: 10 -->
				<!-- Title: Code for Nulls -->
				<!-- -------------------------------------------------------------------- -->

				<section data-background="#002b36">
					<p>case when using IN keyword to check elements belonging to a list (generated in a subquery)>
					<pre>
						<code class="hljs" data-trim data-noescape>
							CASE WHEN track_id IN (SELECT id FROM tracks WHERE track_duration > 20)
								THEN 'output_1'
							ELSE NULL END AS in_check
						</code>

					</pre>
				</section>


				<!-- -------------------------------------------------------------------- -->
				<!-- only_code -->
				<!-- id: 10 -->
				<!-- Title: Code for Nulls -->
				<!-- -------------------------------------------------------------------- -->

				<section data-background="#002b36">
					<p>CASE WHEN using a subquery to calculate one value</p>
					<pre>
						<code class="hljs" data-trim data-noescape>
						CASE WHEN num_col = (SELECT max(other_num_col) FROM table_name)
							THEN 'output_1'
						ELSE NULL END AS subquery_check
						</code>

					</pre>
				</section>


			<!-- -------------------------------------------------------------------- -->
			<!-- table template -->
			<!-- id: 14 -->
			<!-- -------------------------------------------------------------------- -->
			<section class="table">
				<h2>String Functions</h2>
				<table>
					<thead>
						<tr>
							<th>function</th>
							<th>result</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>UPPER(col)</td>
							<td>turns column all upper case</td>
						</tr>
						<tr>
							<td>LOWER(col)</td>
							<td>turns column all lower case</td>
						</tr>
						<tr>
							<td>TRIM(col)</td>
							<td>trims leading and trailing white spaces</td>
						</tr>
						<tr>
							<td>LEFT(col, num)</td>
							<td>extracts [num] number of characters starting from the start of the string</td>
						</tr>
						<tr>
							<td>RIGHT(col, num)</td>
							<td>extracts [num] number of characters starting from the end of the string</td>
						</tr>
						<tr>
							<td>col_1 || col_2 or CONCAT(col_1, col_2)</td>
							<td>concatenates the two strings</td>
						</tr>
					</tbody>
				</table>
			</section>



				<!-- -------------------------------------------------------------------- -->
				<!-- double_bullet_list -->
				<!-- id: 7 -->
				<!-- Title:  -->
				<!-- -------------------------------------------------------------------- -->

				<section data-background="#002b36">
					<h5>LIKE operator</h5>
					<div class="side-bullet-point">
						<p>You may want to use the LIKE operator to match substrings</p>
						<div>
							<ul>
								<li>Good to use in WHERE clauses or in CASE WHENs</li>
								<li>Special characters:</li>
									<ul>
										<li>% -->  Match any character, any amount</li>
										<li>_ -->  Match any character, one count</li>
										<li>[] --> Match range of characters</li>
									</ul>
								
								<li>General Use:</li>
									<ul>
										<li>string_col LIKE '%substring to match%'</li>
										<li>will evaluate to True if 'substring to match' is in the value contained in string_col</li>
									</ul>
								
							</ul>
						</div>
					</div>
				</section>



				<!-- -------------------------------------------------------------------- -->
				<!-- only_code -->
				<!-- id: 10 -->
				<!-- Title: Code for Nulls -->
				<!-- -------------------------------------------------------------------- -->

				<section data-background="#002b36">
					<p>Example with LIKE</p>
					<pre>
						<code class="hljs" data-trim data-noescape>
							SELECT
								col_1
								,col_2
								FROM table_name
							WHERE col_1 LIKE 'search%'; 
							-- this will match any string that starts with the word 'search' 
						</code>

					</pre>
				</section>



				<!-- -------------------------------------------------------------------- -->
				<!-- h3 Title and bullet points template -->
				<!-- id: 5 -->
				<!-- -------------------------------------------------------------------- -->

				<section data-background="#002b36">
					<h5>Tips</h5>
					<ul>
						<li>always be careful to put the % characters in the right places!</li>
						<li>can do insensitive case search with:</li>
							<ul>
								<li>lower(my_col) like '%substring%'</li>
								<li>my_col ilike '%substring%' -- (in PostgreSQL)</li>
							</ul>
					</ul>
				</section>

		</section>




		<!-- -------------------------------------------------------------------- -->
		<!-- footer template -->
		<!-- id: 12 -->
		<!-- -------------------------------------------------------------------- -->

		<div id="footer-left">
			Noisebridge SQL Class
			<img src="../slide/assets/nb_logo.svg" alt="Noisebridge Logo" />
		</div>

		</div>
	</div>

	<script src="../slide/reveal/js/reveal.js"></script>

	<script>
			Reveal.initialize({
				dependencies: [
				{ src: '../slide/reveal/plugin/markdown/marked.js', async: true },
				{ src: '../slide/reveal/plugin/markdown/markdown.js', async: true },
				{ src: '../slide/reveal/plugin/notes/notes.js', async: true },
				{ src: '../slide/reveal/plugin/highlight/highlight.js', async: true },
				{ src: '../slide/reveal/plugin/zoom-js/zoom.js', async: true },
				]
			});
		</script>
	</body>
	</html>

